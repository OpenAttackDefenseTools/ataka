from sqlalchemy import Column, String, DateTime, func, ForeignKey, Boolean
from sqlalchemy.orm import relationship

from ..config import Base, JsonBase


class Exploit(Base, JsonBase):
    __tablename__ = "exploits"

    id = Column(String, primary_key=True)
    exploit_history_id = Column(String, ForeignKey("exploit_histories.id"))
    docker_name = Column(String, unique=True, index=True)
    active = Column(Boolean)
    author = Column(String)
    timestamp = Column(DateTime(timezone=True), server_default=func.now())

    exploit_history = relationship("ExploitHistory", back_populates="exploits")
